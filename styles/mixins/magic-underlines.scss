$selectionColor: #b4d5fe;

@mixin magic-underline($color, $backgroundColor) {
	color: $color;
	text-decoration: none;
	@include textShadowToCropUnderline($backgroundColor);
	background-image:
		linear-gradient($backgroundColor, $backgroundColor),
		linear-gradient($backgroundColor, $backgroundColor),
		linear-gradient($color, $color);
	background-size: .05em 2px, .05em 2px, 1px 2px;
	background-repeat: no-repeat, no-repeat, repeat-x;
	background-position: left bottom .1em, right bottom .1em, left bottom .1em;
	
	&::selection {
		@include textShadowToCropUnderline($selectionColor);
		background: $selectionColor;
	}
	
	&:before, &:after, *, *:before, *:after {
		text-shadow: none;
	}
	
	&:visited {
		color: $color;
	}
}

@mixin textShadowToCropUnderline($color) {
	text-shadow:
		0  2px $color,
		0 -2px $color,
		0 -3px $color, // Helps  g
		 2px 0 $color,
		-2px 0 $color,
		 3px 0 $color, // Helps y
		 4px 0 $color,
		-4px 0 $color;
}
